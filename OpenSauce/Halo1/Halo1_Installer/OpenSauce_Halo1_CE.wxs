<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi' xmlns:util='http://schemas.microsoft.com/wix/UtilExtension'>
	<Product Name='OpenSauce for Halo CE' 
		Id='BEF3C4CC-CCAB-47FF-AE26-F44319A220AA' 
		UpgradeCode='6E7F244E-C79F-4925-A073-66362D92A99F'
		Language='1033' 
		Codepage='1252' 
		Version='2.5.0' 
		Manufacturer='Kornner Studios'>

		<Package Id='*' 
			Keywords='Installer' 
			Description='OpenSauce for Halo CE Installer'
			Comments='Extensions for Halo Custom Edition that add new features and capabilities' 
			Manufacturer='Kornner Studios'
			InstallerVersion='100' 
			Languages='1033' 
			Compressed='yes' 
			SummaryCodepage='1252' />

		<!-- Get the Halo CE root directory from the registry -->
		<Property Id='HALO1_CE_HCE_INSTALLDIR_PROP'>
			<RegistrySearch Id='Halo1_CE_HCE_InstallDir_REG' Type='raw' Root='HKLM' Key='Software\Microsoft\Microsoft Games\Halo CE' Name='EXE Path' />
		</Property>
		<!-- Check whether the Halo CE directory exists -->
		<Property Id='HALO1_CE_HCE_INSTALLDIREXIST_PROP'>
			<DirectorySearch Id='Halo1_CE_HCE_InstallDir_DIRSRCH' Path='[HALO1_CE_HCE_INSTALLDIR_PROP]' />
		</Property>
		
		<!-- Get the HEK installation directory from the registry -->
		<Property Id='HALO1_CE_HEK_INSTALLDIR_PROP'>
  			<RegistrySearch Id='Halo1_CE_HEK_InstallDir_REG' Type='raw' Root='HKLM' Key='Software\Microsoft\Microsoft Games\Halo HEK' Name='EXE Path' />
		</Property>
		<!-- Check whether the HEK installation directory exists -->
		<Property Id='HALO1_CE_HEK_INSTALLDIREXIST_PROP'>
			<DirectorySearch Id='Halo1_CE_HEK_InstallDir_DIRSRCH' Path='[HALO1_CE_HEK_INSTALLDIR_PROP]' />
		</Property>
		<!-- Find guerilla.exe in the default HEK directory -->
		<Property Id='HALO1_CE_HEK_GUERILLAPATH_PROP'>
			<DirectorySearch Id='Halo1_CE_HEK_GuerillaPath_DIRSRCH' Path='[HALO1_CE_HEK_INSTALLDIR_PROP]'>
				<FileSearch Id='Halo1_CE_HEK_GuerillaPath_FILESRCH' Name='guerilla.exe' />
			</DirectorySearch>
		</Property>
		<!-- Find sapien.exe in the default HEK directory -->
		<Property Id='HALO1_CE_HEK_SAPIENPATH_PROP'>
			<DirectorySearch Id='Halo1_CE_HEK_SapienPath_DIRSRCH' Path='[HALO1_CE_HEK_INSTALLDIR_PROP]'>
				<FileSearch Id='Halo1_CE_HEK_SapienPath_FILESRCH' Name='sapien.exe' />
			</DirectorySearch>
		</Property>
		<!-- Find tool.exe in the default HEK directory -->
		<Property Id='HALO1_CE_HEK_TOOLPATH_PROP'>
			<DirectorySearch Id='Halo1_CE_HEK_ToolPath_DIRSRCH' Path='[HALO1_CE_HEK_INSTALLDIR_PROP]'>
				<FileSearch Id='Halo1_CE_HEK_ToolPath_FILESRCH' Name='tool.exe' />
			</DirectorySearch>
		</Property>
		<!-- Set the output path for the OS HEK EXEs to the default HEK directory -->
		<Property Id='HALO1_CE_HEK_OUTPUTPATH_PROP'>
			<DirectorySearch Id='Halo1_CE_HEK_OutputDir_DIRSRCH' Path='[HALO1_CE_HEK_INSTALLDIR_PROP]' />
		</Property>
		<!-- Setting any value to this property defaults to launching OS_IDE when guerilla\sapien\tool is missing -->
		<Property Id='HALO1_CE_HEK_LAUNCHOSIDE_PROP' Value='0' />
		
		<!-- Get the haloce.exe file version (will not be assigned if version is below 1.09) -->
		<Property Id='HALO1_CE_HCE_VERSION_109_PROP'>
			<DirectorySearch Id='Halo1_CE_HCE_Version_109_DIRSRCH' Path='[HALO1_CE_HCE_INSTALLDIR_PROP]'>
				<FileSearch Id='Halo1_CE_HCE_Version_109_FILESRCH' Name='haloce.exe' MinVersion='1.0.9.619' MaxVersion='1.0.9.620'/>
			</DirectorySearch>
		</Property>
		<!-- Get the Halo CE directory in the Documents folder, searches 2 directories deep -->
		<Property Id='HALO1_CE_HCE_USERPATH_PROP'>
			<DirectorySearch Id='Halo1_CE_HCE_UserPath_DIRSRCH' Path='[PersonalFolder]\My Games'>
				<DirectorySearch Id='Halo1_CE_HCE_HaloCEPath_DIRSRCH' Path='Halo CE' Depth='2' />
			</DirectorySearch>
		</Property>
		
		<!-- CONDITION: fail if there is no Halo CE dir registry entry : HALO1_CE_HCE_INSTALLDIR_PROP has not been set -->
		<Condition Message='Halo CE root directory registry entry not found. Please reinstall Halo CE and run this installer again.'>
			<![CDATA[HALO1_CE_HCE_INSTALLDIR_PROP]]>
		</Condition>
		<!-- CONDITION: fail if the Halo CE directory doesn't exist : HALO1_CE_HCE_INSTALLDIREXIST_PROP has not been set -->
		<Condition Message='Halo CE root directory not found. Please reinstall Halo CE and run this installer again.'>
			<![CDATA[HALO1_CE_HCE_INSTALLDIREXIST_PROP]]>
		</Condition>
		<!-- CONDITION: fail if the Halo CE user directory doesn't exist : HALO1_CE_HCE_USERPATH_PROP has not been set -->
		<Condition Message='Halo CE user directory not found. Please reinstall Halo CE and run this installer again.'>
			<![CDATA[HALO1_CE_HCE_USERPATH_PROP]]>
		</Condition>
		<!-- CONDITION: fail if the version is below 1.09 : HALO1_CE_HCE_VERSION_109_PROP has not been set -->
		<Condition Message='Halo CE version is incorrect. Update to Halo CE version 1.09 and run this installer again.'>
			<![CDATA[HALO1_CE_HCE_VERSION_109_PROP]]>
		</Condition>

		<Media Id='1' Cabinet='Halo1_CE_OpenSauce.cab' EmbedCab='yes' DiskPrompt='CD-ROM #1' />	
		<Property Id='DiskPrompt' Value='OpenSauce for Halo CE Installation [1]' />	

		<Directory Id='TARGETDIR' Name='SourceDir'>
			<!-- Files and folders that belong in the Halo CE root directory -->
			<Directory Id='HALO1_CE_HCE_INSTALLDIR_PROP' Name='Halo Custom Edition' FileSource='Resources\Halo1_CE\HCE_InstallDir'>
				<Directory Id='Halo1_CE_shaders_DIR' Name='shaders'>
					<Component Id='Halo1_CE_vsh_OS_COMP' Guid='A0714B15-01C1-4ED1-B74D-D52E9B61E23E'>
						<File Id='Halo1_CE_vsh_OS_FILE' Name='vsh_OS.enc' DiskId='1' KeyPath='yes' />
					</Component>
					<Component Id='Halo1_CE_EffectCollection_ps_2_a_COMP' Guid='727C3471-F50C-49CC-A0E3-8426ADE14654'>
						<File Id='Halo1_CE_EffectCollection_ps_2_a_FILE' Name='EffectCollection_ps_2_a.enc' DiskId='1' KeyPath='yes' />
					</Component>
					<Component Id='Halo1_CE_EffectCollection_ps_2_b_COMP' Guid='0D6D2D77-6F64-4136-BF93-526235A53FD0'>
						<File Id='Halo1_CE_EffectCollection_ps_2_b_FILE' Name='EffectCollection_ps_2_b.enc' DiskId='1' KeyPath='yes' />
					</Component>
				</Directory>
				
				<Component Id='Halo1_CE_d3d9109_COMP' Guid='F5D1A284-D067-443F-BE7C-4E6FD5574553'>
					<File Id='Halo1_CE_d3d9109_FILE' Name='d3d9.dll' DiskId='1' Source='..\..\..\bin\Release\Halo1_CE\d3d9.dll' KeyPath='yes' />
				</Component>
			</Directory>

			<!-- Files and folders that belong in the HEK root directory -->
			<Directory Id='HALO1_CE_HEK_INSTALLDIR_PROP' Name='Halo Custom Edition' FileSource='..\..\..\shared\Resources\Halo1_CheApe\HEK_InstallDir'>
				<Directory Id='Halo1_CE_data_DIR' Name='data'>
					<Directory Id='Halo1_CE_data_postprocess_DIR' Name='postprocess'>
						<Directory Id='Halo1_CE_includes_DIR' Name='includes'>
							<Component Id='Halo1_CE_gbuffer_functions_FX_COMP' Guid='887C91EE-2EC8-4251-8518-02892F230B50'>
								<File Id='Halo1_CE_gbuffer_functions_FX_FILE' Name='gbuffer_functions.fx' DiskId='1' KeyPath='yes' />
							</Component>
							<Component Id='Halo1_CE_vertex_shaders_FX_COMP' Guid='E9C6528F-460C-4693-8E11-2818F48305A8'>
								<File Id='Halo1_CE_vertex_shaders_FX_FILE' Name='vertex_shaders.fx' DiskId='1' KeyPath='yes' />
							</Component>
						</Directory>
						
						<Component Id='Halo1_CE_sepia_FX_COMP' Guid='F991E8D7-4DD3-4A14-B62C-79AEF83B6DF6'>
							<File Id='Halo1_CE_sepia_FX_FILE' Name='sepia.fx' DiskId='1' KeyPath='yes' />
						</Component>
						<Component Id='Halo1_CE_visr_FX_COMP' Guid='ED3FA66A-119F-4193-94A3-E875A33E2C86'>
							<File Id='Halo1_CE_visr_FX_FILE' Name='visr.fx' DiskId='1' KeyPath='yes' />
						</Component>
					</Directory>
				</Directory>
				
				<Directory Id='Halo1_CE_tags_DIR' Name='tags'>
					<Directory Id='Halo1_CE_tags_postprocess_DIR' Name='postprocess'>
						<Component Id='Halo1_CE_sepia_SHPG_COMP' Guid='7498F601-2905-49E2-A8C4-EE63BD6DE633'>
							<File Id='Halo1_CE_sepia_SHPG_FILE' Name='sepia.shader_postprocess_generic' DiskId='1' KeyPath='yes' />
						</Component>
						<Component Id='Halo1_CE_sepia_blue_SHPG_COMP' Guid='343978B8-8FDE-4935-901A-3AAC7945D1E1'>
							<File Id='Halo1_CE_sepia_blue_SHPG_FILE' Name='sepia blue.shader_postprocess_generic' DiskId='1' KeyPath='yes' />
						</Component>
						<Component Id='Halo1_CE_visr_SHPG_COMP' Guid='A2B2EAE2-022D-416B-AE80-3CD8683D5B8C'>
							<File Id='Halo1_CE_visr_SHPG_FILE' Name='visr.shader_postprocess_generic' DiskId='1' KeyPath='yes' />
						</Component>
					</Directory>
				</Directory>
				
				<Component Id='Halo1_CE_CheApeDLLG_COMP' Guid='B8C6DFF9-6CF7-4571-8A7E-3082D16548BE'>
					<File Id='Halo1_CE_CheApeDLLG_FILE' Name='CheApeDLLG.dll' DiskId='1' Source='..\..\..\bin\DebugGuerilla\Halo1_CheApe\CheApeDLLG.dll' KeyPath='yes' />
				</Component>
				<Component Id='Halo1_CE_CheApeDLLS_COMP' Guid='79045663-35F5-41EC-BBFE-F4CA58C1410C'>
					<File Id='Halo1_CE_CheApeDLLS_FILE' Name='CheApeDLLS.dll' DiskId='1' Source='..\..\..\bin\DebugSapien\Halo1_CheApe\CheApeDLLS.dll' KeyPath='yes' />
				</Component>
				<Component Id='Halo1_CE_CheApeDLLT_COMP' Guid='457412A1-749A-4B82-AAFF-91C848D81E70'>
					<File Id='Halo1_CE_CheApeDLLT_FILE' Name='CheApeDLLT.dll' DiskId='1' Source='..\..\..\bin\DebugTool\Halo1_CheApe\CheApeDLLT.dll' KeyPath='yes' />
				</Component>
				
				<Component Id='Halo1_CE_OpenSauceIDE_COMP' Guid='B9699EB8-F18C-4FAF-B97B-227B865AF0BB'>
					<File Id='Halo1_CE_OpenSauceIDE_FILE' Name='OpenSauceIDE.exe' DiskId='1' Source='..\..\..\bin\Release\x86\OpenSauceIDE\OpenSauceIDE.exe' KeyPath='yes' />
				</Component>
				<Component Id='Halo1_CE_BlamLib_COMP' Guid='66445DEB-325D-463F-8850-19E2AFA2BE16'>
					<File Id='Halo1_CE_BlamLib_FILE' Name='BlamLib.dll' DiskId='1' Source='..\..\..\bin\Release\x86\OpenSauceIDE\BlamLib.dll' KeyPath='yes' />
				</Component>
				<Component Id='Halo1_CE_BlamLib_Forms_COMP' Guid='CF1070AA-7709-46AC-80FA-C1385E850CD6'>
					<File Id='Halo1_CE_BlamLib_Forms_FILE' Name='BlamLib.Forms.dll' DiskId='1' Source='..\..\..\bin\Release\x86\OpenSauceIDE\BlamLib.Forms.dll' KeyPath='yes' />
				</Component>
				<Component Id='Halo1_CE_LowLevel_COMP' Guid='F93E1D0E-103F-42C1-A5AF-42FD8021D302'>
					<File Id='Halo1_CE_LowLevel_FILE' Name='LowLevel.dll' DiskId='1' Source='..\..\..\bin\Release\x86\OpenSauceIDE\LowLevel.dll' KeyPath='yes' />
				</Component>
				
				<Component Id='Halo1_CE_CheApe_COMP' Guid='744A1187-E0BC-47d9-B4DE-7EDD9A39F0DA'>
					<File Id='Halo1_CE_CheApe_FILE' Name='CheApe.map' DiskId='1' KeyPath='yes' />
				</Component>
				
				<Component Id='Halo1_CE_OS_Settings_Editor_COMP' Guid='E48FA000-32FA-446D-9A06-8CFD8C7F428B'>
					<File Id='Halo1_CE_OS_Settings_Editor_FILE' Name='OS_Settings.Editor.xml' DiskId='1' KeyPath='yes' />
					<util:XmlFile Id='Halo1_CE_Halo1_CE_OS_Settings_Editor_XML' 
						Action='setValue' 
						ElementPath='//profiles/Profile/root' 
						Value='[HALO1_CE_HEK_INSTALLDIR_PROP]' 
						File='[#Halo1_CE_OS_Settings_Editor_FILE]' 
						Sequence='1' />
				</Component>
				
				<Component Id='Halo1_CE_HEKExeRemove_COMP' Guid='55F95267-1323-4F28-A4A9-7D5A52DE0337'>
					<RemoveFile Id='Halo1_CE_OS_Guerilla_REM' Name='OS_Guerilla.exe' On='uninstall' />
					<RemoveFile Id='Halo1_CE_OS_Sapien_REM' Name='OS_Sapien.exe' On='uninstall' />
					<RemoveFile Id='Halo1_CE_OS_Tool_REM' Name='OS_Tool.exe' On='uninstall' />
				</Component>
			</Directory>
			
			<!-- Files and folders that belong in the users Documents\My Games\Halo CE directory -->
			<Directory Id='HALO1_CE_HCE_USERPATH_PROP' Name='Halo CE' FileSource='..\..\..\shared\Resources\Halo1_CE\HCE_UserPath'>
				<Directory Id='Halo1_CE_OpenSauce_DIR' Name='OpenSauce'>
					<!-- Remove *.txt reports and remove the Reports folder -->
					<Directory Id='Halo1_CE_Reports_DIR' Name='Reports'>
						<Component Id='Halo1_CE_Reports_COMP' Guid='6DC987E1-230F-4DA6-A365-113311C50146'>
							<RemoveFile Id='Halo1_CE_Reports_REM' Name='*.*' On='uninstall' />
							<RemoveFolder Id='Halo1_CE_Reports_REMDIR' On='uninstall' />
						</Component>
					</Directory>
					
					<!-- Shaders necessary for gbuffer extensions -->
					<Directory Id='Halo1_CE_OSShaders_DIR' Name='shaders'>
						<Component Id='Halo1_CE_GBufferShaders_COMP' Guid='D894EAE3-9193-4AE4-B158-2117DBB73CFE'>
							<File Id='Halo1_CE_GBufferShaders_FILE' Name='gbuffer_shaders.shd' KeyPath='yes' />
						</Component>
						<Component Id='Halo1_CE_PPShaders_COMP' Guid='547CFB95-B537-4B3F-A0B1-6EE6671D663C'>
							<File Id='Halo1_CE_PPShaders_FILE' Name='pp_shaders.shd' KeyPath='yes' />
						</Component>
						
						<Component Id='Halo1_CE_OSShaders_COMP' Guid='BBA737F2-4BCE-4516-AF07-34CEC2AE47F4'>
							<RemoveFolder Id='Halo1_CE_OSShaders_REMDIR' On='uninstall' />
						</Component>
					</Directory>
					
					<!-- Remove the external shaders folder if empty -->
					<Directory Id='Halo1_CE_PPExtShaders_DIR' Name='postprocess shaders'>
						<Component Id='Halo1_CE_PPExtShaders_COMP' Guid='1AAC4CDB-32C7-4428-B3CD-DF7990876C21'>
							<RemoveFolder Id='Halo1_CE_PPExtShaders_REMDIR' On='uninstall' />
						</Component>
					</Directory>
					
					<!-- User settings -->
					<Component Id='Halo1_CE_OSUserSettings_COMP' Guid='88FD2602-AFD9-40F1-89DD-EDDFB3768ADB'>
						<File Id='Halo1_CE_OSUserSettings_FILE' Name='OS_Settings.User.xml' KeyPath='yes' />
					</Component>
					<Component Id='Halo1_CE_OSServerSettings_COMP' Guid='88EC2CC6-D9A9-472A-897B-28150A7D94E1'>
						<File Id='Halo1_CE_OSServerSettings_FILE' Name='OS_Settings.Server.xml' KeyPath='yes' />
					</Component>
					<Component Id='Halo1_CE_OSPPSettings_COMP' Guid='373BB357-0BEC-4EDD-AD0B-8003A4BBCDD0'>
						<File Id='Halo1_CE_OSPPSettings_FILE' Name='OS_Settings.PostProcessing.xml' KeyPath='yes' />
					</Component>
					
					<!-- Remove the OpenSauce directory if empty -->
					<Component Id='Halo1_CE_OpenSauce_COMP' Guid='4ED59B1D-1E70-4853-98CE-CD4EE118CB3B'>
						<RemoveFolder Id='Halo1_CE_OpenSauce_REMDIR' On='uninstall' />
					</Component>
					
				</Directory>
				
				<!-- Remove all files in the Yelo directory and delete it -->
				<Directory Id='Halo1_CE_Yelo_DIR' Name='Yelo'>
					<Component Id='Halo1_CE_Yelo_COMP' Guid='D7E6C97B-615F-4AFA-86CA-080A519760B9'>
						<RemoveFile Id='Halo1_CE_Yelo_REM' Name='*.*' On='uninstall' />
						<RemoveFolder Id='Halo1_CE_Yelo_REMDIR' On='uninstall' />
					</Component>
				</Directory>
			</Directory>
		</Directory>
		
		<!-- Launches the OS_IDE with the command to create the OS HEK executables -->
		<CustomAction Id='Halo1_CE_CreateOSHEKEXEs_CACT' FileKey='Halo1_CE_OpenSauceIDE_FILE' ExeCommand='-cmdline apply-cheape Halo1_CE "[HALO1_CE_HEK_GUERILLAPATH_PROP]" "[HALO1_CE_HEK_TOOLPATH_PROP]" "[HALO1_CE_HEK_SAPIENPATH_PROP]" "[HALO1_CE_HEK_OUTPUTPATH_PROP]\"' />
		<!-- Launches the OS_IDE with no command -->
		<CustomAction Id='Halo1_CE_LaunchOSIDE_CACT' FileKey='Halo1_CE_OpenSauceIDE_FILE'  Return='asyncNoWait' ExeCommand='' />
		
		<InstallExecuteSequence>
			<!-- If the HEK extensions are being installed only, and the stock exes are available, and the user does not want to skip OS HEK exe creation -->
			<Custom Action='Halo1_CE_CreateOSHEKEXEs_CACT' After='InstallFinalize'>
				<![CDATA[((&Halo1_CE_HEK_FEAT = 3) AND NOT (!Halo1_CE_HEK_FEAT = 3)) AND (HALO1_CE_HEK_GUERILLAPATH_PROP AND HALO1_CE_HEK_SAPIENPATH_PROP AND HALO1_CE_HEK_TOOLPATH_PROP) AND NOT HALO1_CE_HEK_SKIPCREATEOSEXES_PROP]]>
			</Custom>
			<!-- If the HEK extensions are being installed only, and the stock exes are unavailable, and the user wants OS_IDE to be launched -->
			<Custom Action='Halo1_CE_LaunchOSIDE_CACT' After='InstallFinalize'>
				<![CDATA[((&Halo1_CE_HEK_FEAT = 3) AND NOT (!Halo1_CE_HEK_FEAT = 3)) AND (NOT HALO1_CE_HEK_GUERILLAPATH_PROP OR NOT HALO1_CE_HEK_SAPIENPATH_PROP OR NOT HALO1_CE_HEK_TOOLPATH_PROP) AND HALO1_CE_HEK_LAUNCHOSIDE_PROP]]>
			</Custom>
		</InstallExecuteSequence>
		
		<Feature Id='Halo1_CE_Complete_FEAT' 
			Title='OS Halo CE V2.5' 
			Description='All the Sauce you will ever need.' 
			Display='expand' 
			Level='1' 
			ConfigurableDirectory='HALO1_CE_HCE_INSTALLDIR_PROP' 
			AllowAdvertise='no' 
			Absent='disallow'>
			
			<ComponentRef Id='Halo1_CE_d3d9109_COMP' />
			<ComponentRef Id='Halo1_CE_vsh_OS_COMP' />
			<ComponentRef Id='Halo1_CE_EffectCollection_ps_2_a_COMP' />
			<ComponentRef Id='Halo1_CE_EffectCollection_ps_2_b_COMP' />
			
			<ComponentRef Id='Halo1_CE_OSUserSettings_COMP' />
			<ComponentRef Id='Halo1_CE_OSServerSettings_COMP' />
			<ComponentRef Id='Halo1_CE_OSPPSettings_COMP' />
			
			<ComponentRef Id='Halo1_CE_GBufferShaders_COMP' />
			<ComponentRef Id='Halo1_CE_PPShaders_COMP' />
			
			<ComponentRef Id='Halo1_CE_OpenSauce_COMP' />
			<ComponentRef Id='Halo1_CE_Reports_COMP' />
			<ComponentRef Id='Halo1_CE_PPExtShaders_COMP' />
			<ComponentRef Id='Halo1_CE_OSShaders_COMP' />
			<ComponentRef Id='Halo1_CE_Yelo_COMP' />
			
			<Feature Id='Halo1_CE_HEK_FEAT' 
				Title='HEK Extensions' 
				Description='Extensions that add new functionality to the HEK.'
				Level='2' 
				AllowAdvertise='no'>
				
				<ComponentRef Id='Halo1_CE_CheApeDLLG_COMP' />
				<ComponentRef Id='Halo1_CE_CheApeDLLS_COMP' />
				<ComponentRef Id='Halo1_CE_CheApeDLLT_COMP' />
				
				<ComponentRef Id='Halo1_CE_OpenSauceIDE_COMP' />
				<ComponentRef Id='Halo1_CE_BlamLib_COMP' />
				<ComponentRef Id='Halo1_CE_BlamLib_Forms_COMP' />
				<ComponentRef Id='Halo1_CE_LowLevel_COMP' />
				<ComponentRef Id='Halo1_CE_OS_Settings_Editor_COMP' />
				
				<ComponentRef Id='Halo1_CE_gbuffer_functions_FX_COMP' />
				<ComponentRef Id='Halo1_CE_vertex_shaders_FX_COMP' />
				<ComponentRef Id='Halo1_CE_CheApe_COMP' />

				<ComponentRef Id='Halo1_CE_HEKExeRemove_COMP' />
				
				<!-- CONDITION: remove feature option if the HEK directory registry entry was not found, or the directory does not exist -->
				<Condition Level='0'>
					<![CDATA[(NOT HALO1_CE_HEK_INSTALLDIR_PROP) OR (NOT HALO1_CE_HEK_INSTALLDIREXIST_PROP)]]>
				</Condition>
			</Feature>
			
			<Feature Id='Halo1_CE_HEKExampleFiles_FEAT' 
				Title='HEK Example Files' 
				Description='Data and tag files that serve as examples of using the extended HEK' 
				Level='3' 
				AllowAdvertise='no'>
				
				<ComponentRef Id='Halo1_CE_sepia_FX_COMP' />
				<ComponentRef Id='Halo1_CE_visr_FX_COMP' />
				
				<ComponentRef Id='Halo1_CE_sepia_SHPG_COMP' />
				<ComponentRef Id='Halo1_CE_sepia_blue_SHPG_COMP' />
				<ComponentRef Id='Halo1_CE_visr_SHPG_COMP' />
				
				<!-- CONDITION: remove feature option if the HEK directory registry entry was not found, or the directory does not exist -->
				<Condition Level='0'>
					<![CDATA[(NOT HALO1_CE_HEK_INSTALLDIR_PROP) OR (NOT HALO1_CE_HEK_INSTALLDIREXIST_PROP)]]>
				</Condition>
			</Feature>
		</Feature>
		
		<UI Id='Halo1_CE_WixUI_FeatureTree_Ext'>
			<UIRef Id='WixUI_FeatureTree' />
			<DialogRef Id='HEKPathDialog' />
			<DialogRef Id='HEKPathMissingDialog' />
			
			<!-- The HEK extensions are being installed and all three of the stock exes are available, so show the OS HEK creation dialog -->
			<Publish Dialog='CustomizeDlg' Control='Next' Event='NewDialog' Value='HEKPathDialog'>
				<![CDATA[((&Halo1_CE_HEK_FEAT = 3) AND NOT (!Halo1_CE_HEK_FEAT = 3)) AND HALO1_CE_HEK_GUERILLAPATH_PROP AND HALO1_CE_HEK_SAPIENPATH_PROP AND HALO1_CE_HEK_TOOLPATH_PROP]]>
			</Publish>
            <Publish Dialog='VerifyReadyDlg' Control='Back' Event='NewDialog' Value='HEKPathDialog'>
				<![CDATA[((&Halo1_CE_HEK_FEAT = 3) AND NOT (!Halo1_CE_HEK_FEAT = 3)) AND HALO1_CE_HEK_GUERILLAPATH_PROP AND HALO1_CE_HEK_SAPIENPATH_PROP AND HALO1_CE_HEK_TOOLPATH_PROP]]>
			</Publish>
			
			<!-- The HEK extensions are being installed but one of the stock exes is unavailable, so show the OS_IDE launch dialog -->
			<Publish Dialog='CustomizeDlg' Control='Next' Event='NewDialog' Value='HEKPathMissingDialog'>
				<![CDATA[((&Halo1_CE_HEK_FEAT = 3) AND NOT (!Halo1_CE_HEK_FEAT = 3)) AND (NOT HALO1_CE_HEK_GUERILLAPATH_PROP OR NOT HALO1_CE_HEK_SAPIENPATH_PROP OR NOT HALO1_CE_HEK_TOOLPATH_PROP)]]>
			</Publish>
            <Publish Dialog='VerifyReadyDlg' Control='Back' Event='NewDialog' Value='HEKPathMissingDialog'>
				<![CDATA[((&Halo1_CE_HEK_FEAT = 3) AND NOT (!Halo1_CE_HEK_FEAT = 3)) AND (NOT HALO1_CE_HEK_GUERILLAPATH_PROP OR NOT HALO1_CE_HEK_SAPIENPATH_PROP OR NOT HALO1_CE_HEK_TOOLPATH_PROP)]]>
			</Publish>
		</UI>
		
		<UIRef Id='WixUI_ErrorProgressText' />

		<WixVariable Id='WixUIBannerBmp' Value='..\..\..\shared\Resources\Installer\banner.bmp' />
		<WixVariable Id='WixUIDialogBmp' Value='..\..\..\shared\Resources\Installer\dialog.bmp' />
		<WixVariable Id='WixUILicenseRtf' Value='..\..\..\shared\Resources\Installer\gpl.rtf' />
		
	</Product>
</Wix>